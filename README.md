# 无人机路径规划算法对比沙盘（Python 后端 + Web 可视化）

用于研究生课程演示：在同一任务流下，对比 `A* + 贪心` 与 `A* 基线（非贪心分配）` 的调度表现。

## 架构

- 后端（Python）：负责仿真、路径规划、任务调度、指标计算与统计检查
- 前端（HTML/CSS/JS）：只负责可视化渲染与参数控制

## 当前仿真设定

- 地图：2D 平面 + 3 个障碍物
- 站点：`1 个物流中心 + N 个配送点`（`N` 可调，默认 3，范围 3..8）
- 无人机：2 架
- 任务流：固定时间间隔随机生成，统一由物流中心发往配送点
- 载荷机制：
  - 每架无人机有 `载荷上限（任务数）`
  - 在物流中心一次装载多个任务
  - 配送完一个点后直接去下一个点，不返回物流中心（形成环线）
  - 当前批次送完后再回物流中心补货

## 算法

- `A* + 贪心任务分配`
- `A* 基线（非贪心分配，FCFS风格）`

## 可视化

- 双并列沙盘（左 A*+贪心，右 A*基线）
- 指标卡片（平均完成时长、总路程、完成率、平均等待时长、累计完成任务）
- 时序图（累计完成任务数、平均等待时长）

## 结果检查与载荷分析

- `结果检查`：固定当前载荷上限，运行多随机种子统计，输出置信区间结论
- `载荷分析`：自动扫描载荷上限（默认 1..5），比较不同载荷下算法优劣

## 安装依赖

```bash
pip install -r requirements.txt
```

## 启动

```bash
python3 -m uvicorn backend.server:app --host 127.0.0.1 --port 5173
```

浏览器打开：

```text
http://127.0.0.1:5173
```

## 控件说明

- `开始`：开始后端仿真
- `暂停`：暂停后端仿真
- `重置`：按当前参数重置仿真
- `结果检查`：当前载荷下统计评估
- `载荷分析`：多载荷上限扫描
- `随机种子`：控制任务流可复现
- `任务间隔`：控制任务到达频率
- `任务点数量 (配送点)`：控制激活的配送点数量（3..8）
- `载荷上限 (任务/机)`：每架无人机一次可携带任务数
- `速度倍数`：控制后端仿真推进速度

## 后端接口

- `GET /api/state`：获取当前仿真状态
- `POST /api/control/start`：开始
- `POST /api/control/pause`：暂停
- `POST /api/control/reset`：重置（seed/interval/speed/payload_capacity/site_count）
- `POST /api/control/config`：更新 interval/speed/payload_capacity/site_count
- `POST /api/control/advance`：手动推进时间（自动化测试）
- `POST /api/evaluate`：统计评估（支持单载荷或多载荷扫描）

## 科学性检查逻辑

评估器会执行：

- 两算法 `generated` 数一致（公平同任务流）
- `completed <= generated`（守恒约束）
- 关键指标非负
- 多随机种子均值、标准差、95% 置信区间
- 显著性结论与外推边界说明

## 代码结构

- `backend/simulation.py`：仿真引擎（含载荷环线配送）与算法实现
- `backend/evaluation.py`：统计评估与载荷扫描
- `backend/server.py`：FastAPI 服务与控制接口
- `index.html` / `styles.css` / `app.js`：前端可视化
- `progress.md`：开发过程记录
